- Packet Crafting
  - a technique that allows someone to generate a network packet with specific data
  - When you might want to do this
    - Set unusual TCP flags to see how a firewall respondes
      - Xmas tree attack
        - sets flags FIN, URG, PSH all set to on
        - lights up light a Christmas Tree
        - Most modern firewalls won't fall for this trick
    - Fragment packets
      - Try to sneak them by an IPS
      - Or create something that can't be reassembled to soak up resources
  - Goal is to use as few packets as possible
- Packet crafting Stages
_________________________________________________________________________________________
| Assemble      |   Creates packet to be sent                                           |
| Edit          |   Modify the contents of the created packet                           |
| Play          |   Send or resend that packet onto the network                         |   
| Decode        |   Capture and analyze traffic generated by the packet sent (wireshark)|
________________________________________________________________________________________|
  - hping
    - Command line tool to craft packets
    - OPen source spoofing tool
    - Host\Port detection
      - Sends a syn or ack packet to do detection and testing
      - ```hpgin3 -S -p80 -c1 192.168.1.1```
        - Send a SYN request over port 80 of 1 packet to target
      -  ```hpgin3 -A -p80 -c1 192.168.1.1```
         -  Use an ACK packet instead
   -  timestamping
      -  Determine the uptime
      -  Servers may be online for a long time - and if they have been they might not be fully patched
      -  ```ping3 -c2 -S p80 --tcp-timestamp 192.168.1.1```
         -  Send two SYN packets over port 80 to determine uptime
         -  Usually more effective to send 2 packets for this type of request
   -  traceroute
      -  Uses arbitrary packet formats, like probing DNS ports using TCP or UDP to perform traces when ICMP is blocked
      -  ```hping3 --traceroute -V -1 www.diontraining.com```
   -  fragmentation
      -  Attempts to evade detection by IDS\IPS and firewalls by sending fragmented packets across the network for later reassembly
      -  Was more useful back in the day
      -  Modern OS won't fall for this shit
   -  DoS
      -  flood-based DoS from randomized source IPs
      -  Not likely to be effective against more modern OS and network appliances
      -  May be valid against some SCADA or embedded systems
- scapy
 - Python script
 - Powerful, interactive packet manipulation tool, packet generator, network scanner, network discovery, packet sniffer, and more
 - Two versions
   - 2 and 3 for respective python versions
   - ```scapy3 -h```
     - Show help for Scapy
```bash
Usage: scapy.py [-s sessionfile] [-c new_startup_file] [-p new_prestart_file] [-C] [-P] [-H]
Args:
        -H: header-less start
        -C: do not read startup file
        -P: do not read pre-startup file
```

